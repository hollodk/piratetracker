{% extends "::base.html.twig" %}

{% block body %}
<div class="row">
    <div class="col-md-9">
        {% if is_granted('IS_AUTHENTICATED_REMEMBERED') == false %}
        <div class="panel panel-primary visible-sm visible-xs">
            <div class="panel-heading">
                Signup
            </div>
            <div class="panel-body">
                <p>Not yet on-board? Follow this signup procedure.</p>
                <a class="btn btn-primary" href="{{ path('hollo_tracker_signup_index') }}">Sign up</a>
            </div>
        </div>
        <div class="panel panel-primary visible-sm visible-xs">
            <div class="panel-heading">
                Forgot password
            </div>
            <div class="panel-body">
                <p>Forgot your password :( Follow this procedure.</p>
                <a class="btn btn-primary" href="{{ path('hollo_tracker_signup_reset') }}">Forgot password</a>
            </div>
        </div>

        {% endif %}

        <div class="panel panel-default">
            <div class="panel-heading">
                Map of suspects
            </div>
            <div class="panel-body">
                {{ google_map(map) }}
            </div>
        </div>

    </div>
    <div class="col-md-3">
        {% if is_granted('IS_AUTHENTICATED_REMEMBERED') == false %}
        <div class="panel panel-primary hidden-sm hidden-xs">
            <div class="panel-heading">
                Signup
            </div>
            <div class="panel-body">
                <p>Not yet on-board? Follow this signup procedure.</p>
                <a class="btn btn-primary" href="{{ path('hollo_tracker_signup_index') }}">Sign up</a>
            </div>
        </div>
        <div class="panel panel-primary hidden-sm hidden-xs">
            <div class="panel-heading">
                Forgot password
            </div>
            <div class="panel-body">
                <p>Forgot your password :( Follow this procedure.</p>
                <a class="btn btn-primary" href="{{ path('hollo_tracker_signup_reset') }}">Forgot password</a>
            </div>
        </div>

        {% endif %}

        <div class="panel panel-default">
            <div class="panel-heading">
                Pirates
            </div>
            <div class="panel-body">
                {% for fraction in fractions %}
                <b>{{ fraction.name }} {% if fraction.icon %}<img style="height: 24px" src="{{ asset('bundles/hollotracker/images/'~fraction.icon) }}" />{% endif %}</b><br>

                {% for user in fraction.users %}
                {% if currentUser is defined and currentUser == user %}[{% endif %}
                <a href="{{ path('hollo_tracker_dashboard_track', {'id':user.id}) }}">{{ user.username }}</a>
                {% if user.position and user.position.lastReporting < 120 %}
                <small><span class="label label-success">{{ user.position.lastReporting }} min ago</span></small>
                {% else %}
                <small><span class="label label-danger">silent</span></small>
                {% endif %}

                {% if currentUser is defined and currentUser == user %}]{% endif %}<br>
                {% endfor %}

                {% if loop.last == false %}<hr>{% endif %}
                {% endfor %}
            </div>
        </div>

    </div>

{% endblock %}
